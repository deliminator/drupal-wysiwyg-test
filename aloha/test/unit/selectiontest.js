/* selectiontest.js is part of Aloha Editor project http://aloha-editor.org
 *
 * Aloha Editor is a WYSIWYG HTML5 inline editing library and editor. 
 * Copyright (c) 2010-2012 Gentics Software GmbH, Vienna, Austria.
 * Contributors http://aloha-editor.org/contribution.php 
 * 
 * Aloha Editor is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or any later version.
 *
 * Aloha Editor is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
 * 
 * As an additional permission to the GNU GPL version 2, you may distribute
 * non-source (e.g., minimized or compacted) forms of the Aloha-Editor
 * source code without the copy of the GNU GPL normally required,
 * provided you include this license notice and a URL through which
 * recipients can access the Corresponding Source.
 */

define(["testutils"],function(e){var t=["{}",["{}foo","[]foo"],"foo[]",["foo{}","foo[]"],"[foo]",["{foo}","[foo]"],"[bam]foo",["{bam]foo","[bam]foo"],"bam[foo]",["bam[foo}","bam[foo]"],"bam[]foo","foo[bar]baz",["foo[\0]baz","foo[]baz"],["foo[]baz","foo[]baz"]],n=[["foo[]<br>baz","foo[]<br>baz"],["foo<br>[]baz","foo<br>[]baz"],["foo[}<br>baz","foo[]<br>baz"],["foo<br>{]baz","foo<br>[]baz"],["foo[<br>]baz","foo{<br>}baz"],["foo{<br>]baz","foo{<br>}baz"],["foo[<br>}baz","foo{<br>}baz"],["foo{<br>}baz","foo{<br>}baz"],["[foo<br>]baz","[foo<br>}baz"],["foo[<br>baz]","foo{<br>baz]"],["foo[<br><br>}baz","foo{<br><br>}baz"],["foo[<br><br>]baz","foo{<br><br>}baz"],["foo{<br><br>}baz","foo{<br><br>}baz"],["foo{<br><br>]baz","foo{<br><br>}baz"],["<span data-end=2>foo[<br><br>baz</span>","<span>foo{<br>}<br>baz</span>"],["<span data-end=2>foo{<br><br>baz</span>","<span>foo{<br>}<br>baz</span>"],["<span data-start=2>foo<br><br>]baz</span>","<span>foo<br>{<br>}baz</span>"],["<span data-start=2>foo<br><br>}baz</span>"
,"<span>foo<br>{<br>}baz</span>"],["foo<span>{}<br></span>baz","foo[]<span><br></span>baz"],["foo<span><br>{}</span>baz","foo<span><br></span>[]baz"],["foo{<span>}<br></span>baz","foo[]<span><br></span>baz"],["foo<span><br>{</span>}baz","foo<span><br></span>[]baz"],["foo[<span>}<br></span>baz","foo[]<span><br></span>baz"],["foo<span><br>{</span>]baz","foo<span><br></span>[]baz"],["foo{<span><br></span>}baz","foo<span>{<br>}</span>baz"],["foo[<span><br></span>]baz","foo<span>{<br>}</span>baz"]],r=[["{<b>foo]</b>","<b>[foo]</b>"],["foo{<b>bar]</b>","foo<b>[bar]</b>"],["{<b></b><p>foo]</p>","<b></b><p>[foo]</p>"],["foo<p>{<b></b></p>bar]","foo<p><b></b></p>[bar]"],["foo<p></p>{<b></b><p></p>bar]","foo<p></p><b></b><p></p>[bar]"],["<p>foo</p>{<b></b>bar]","<p>foo</p><b></b>[bar]"],["foo{<b></b><p>bar]</p>","foo<b>{</b><p>bar]</p>"],["<p>foo{<b></b></p>bar]","<p>foo<b>{</b></p>bar]"],["foo{<b></b><u></u><p>bar]</p>","foo<b></b><u>{</u><p>bar]</p>"],["<p>foo{<b></b><u></u></p>bar]","<p>foo<b></b><u>{</u></p>bar]"
],"foo<span>[bar]</span>baz",["foo[<span>bar</span>]baz","foo<span>[bar]</span>baz"],["foo<span>{bar}</span>baz","foo<span>[bar]</span>baz"],["foo{<span>bar</span>}baz","foo<span>[bar]</span>baz"],["foo<span>{bar]</span>baz","foo<span>[bar]</span>baz"],["foo<span>{bar</span>]baz","foo<span>[bar]</span>baz"],["foo<span>[bar}</span>baz","foo<span>[bar]</span>baz"],["foo[<span>bar}</span>baz","foo<span>[bar]</span>baz"],"[foo<span>bar]</span>baz",["[foo<span>]bar</span>baz","[foo]<span>bar</span>baz"],["foo[<span>bar]</span>baz","foo<span>[bar]</span>baz"],["foo[<span>]bar</span>baz","foo[]<span>bar</span>baz"],["{foo<span>bar}</span>baz","[foo<span>bar]</span>baz"],["{foo<span>}bar</span>baz","[foo]<span>bar</span>baz"],["foo{<span>bar}</span>baz","foo<span>[bar]</span>baz"],["foo{<span>}bar</span>baz","foo[]<span>bar</span>baz"],["foo<span>[bar</span>baz]","foo<span>[bar</span>baz]"],["foo<span>bar[</span>baz]","foo<span>bar</span>[baz]"],["foo<span>[bar</span>]baz","foo<span>[bar]</span>baz"
],["foo<span>bar[</span>]baz","foo<span>bar[]</span>baz"],["foo<span>{bar</span>baz}","foo<span>[bar</span>baz]"],["foo<span>bar{</span>baz}","foo<span>bar</span>[baz]"],["foo<span>{bar</span>}baz","foo<span>[bar]</span>baz"],["foo<span>bar{</span>}baz","foo<span>bar[]</span>baz"],["foo{<span><b><b><b>bar}</b></b></b></span>baz","foo<span><b><b><b>[bar]</b></b></b></span>baz"],["foo<span><b>{<b><b>bar}</b></b></b></span>baz","foo<span><b><b><b>[bar]</b></b></b></span>baz"],["foo{<span><b><b><b>}bar</b></b></b></span>baz","foo[]<span><b><b><b>bar</b></b></b></span>baz"],["foo<span><b>{<b><b>}bar</b></b></b></span>baz","foo[]<span><b><b><b>bar</b></b></b></span>baz"],["foo{<span><b><b><b>]bar</b></b></b></span>baz","foo[]<span><b><b><b>bar</b></b></b></span>baz"],["foo<span><b>{<b><b>]bar</b></b></b></span>baz","foo[]<span><b><b><b>bar</b></b></b></span>baz"],["foo{<span><b><br><b><b>bar}</b></b></b></span>baz","foo<span><b>{<br><b><b>bar]</b></b></b></span>baz"],["foo{<span><i><u><b>bar}</b></u></i></span>baz"
,"foo<span><i><u><b>[bar]</b></u></i></span>baz"],["foo<i></i>{<span><b><b>}bar</b></b></span>baz","foo[]<i></i><span><b><b>bar</b></b></span>baz"],["foo<i>a</i>{<span><b><b>}bar</b></b></span>baz","foo<i>a[]</i><span><b><b>bar</b></b></span>baz"],["foo<i>a</i>{<span><b><b>}bar</b></b></span>baz","foo<i>a[]</i><span><b><b>bar</b></b></span>baz"],["<i></i>{<span><b><b>}bar</b></b></span>baz","<i></i><span><b><b>[]bar</b></b></span>baz"],["<span>{<span><b><b>}bar</b></b></span>baz</span>","<span><span><b><b>[]bar</b></b></span>baz</span>"],["test<span>{<span><b><b>}bar</b></b></span>baz</span>","test[]<span><span><b><b>bar</b></b></span>baz</span>"],["<b><i>foo</i></b>{<span><b><b>}bar</b></b></span>baz","<b><i>foo[]</i></b><span><b><b>bar</b></b></span>baz"],["<b><i></i></b>{<span><b><b>}bar</b></b></span>baz","<b><i></i></b><span><b><b>[]bar</b></b></span>baz"],["<b>foo<i></i></b>{<span><b><b>}bar</b></b></span>baz","<b>foo[]<i></i></b><span><b><b>bar</b></b></span>baz"],["{<span><b><b>}bar</b></b></span>baz"
,"<span><b><b>[]bar</b></b></span>baz"],"foo<span>[bar</span><span>baz]</span>bam",["foo<span>bar[</span><span>]baz</span>bam","foo<span>bar[]</span><span>baz</span>bam"]],i=[["foo{<span><span><span><span>bar}</span></span></span></span>baz","foo<span><span><span><span>[bar]</span></span></span></span>baz"],["foo<span><span>{<span><span>bar}</span></span></span></span>baz","foo<span><span><span><span>[bar]</span></span></span></span>baz"],["foo{<span><span><span><span>}bar</span></span></span></span>baz","foo[]<span><span><span><span>bar</span></span></span></span>baz"],["foo<span><span>{<span><span>}bar</span></span></span></span>baz","foo[]<span><span><span><span>bar</span></span></span></span>baz"],["foo{<span><span><span><span>]bar</span></span></span></span>baz","foo[]<span><span><span><span>bar</span></span></span></span>baz"],["foo<span><span>{<span><span>]bar</span></span></span></span>baz","foo[]<span><span><span><span>bar</span></span></span></span>baz"],["foo{<span><span><br><span><span>bar}</span></span></span></span>baz"
,"foo<span><span>{<br><span><span>bar]</span></span></span></span>baz"],["foo{<span><i><u><b>bar}</b></u></i></span>baz","foo<span><i><u><b>[bar]</b></u></i></span>baz"],"foo<span>[bar</span><span>baz]</span>bam",["foo<span>bar[</span><span>]baz</span>bam","foo<span>bar[]</span><span>baz</span>bam"]],s=[["foo{<b></b><p>bar]</p>","foo<b>{</b><p>bar]</p>"],["foo[]<blockquote>bar</blockquote>","foo[]<blockquote>bar</blockquote>"],["foo[]<div><p>bar</p></div>","foo[]<div><p>bar</p></div>"],["foo[] <div><p>bar</p>","foo []<p>bar</p>"],["foo <span>&nbsp;</span>[] bar","foo <span>&nbsp;</span>[] bar"]],o=[["foo{<p>bar]</p>","foo[<p>bar]</p>"],["<b>foo</b>{<p>bar]</p>","<b>foo[</b><p>bar]</p>"],["foo<div>{<p>bar]</p></div>","foo<div><p>[bar]</p></div>"],["<b>foo</b><div>{<p>bar]</p></div>","<b>foo</b><div><p>[bar]</p></div>"],["<b>foo<u>foo1<i>foo2</i></u></b>{<p>bar]</p>","<b>foo<u>foo1<i>foo2[</i></u></b><p>bar]</p>"],["foo<b></b>{<p>bar]</p>","foo<b>{</b><p>bar]</p>"],["foo<b></b><u></u>{<p>bar]</p>"
,"foo<b></b><u>{</u><p>bar]</p>"],["foo<b><u></u></b>{<p>bar]</p>","foo<b><u>{</u></b><p>bar]</p>"],["<u><i>foo</i></u><b></b>{<p>bar]</p>","<u><i>foo</i></u><b>{</b><p>bar]</p>"],["<b></b>{<p>foo]</p>","<b></b><p>[foo]</p>"],["<b><b></b></b>{<p>bar]</p>","<b><b></b></b><p>[bar]</p>"],["{<p>foo]</p>","<p>[foo]</p>"],["{<p><b>foo</b>bar]</p>","<p><b>[foo</b>bar]</p>"],["{<p><b></b>foo]</p>","<p><b></b>[foo]</p>"],["foo<p></p>{<p>bar]</p>","foo<p></p><p>[bar]</p>"],["<i>foo</i><b></b>{<p>bar]</p>","<i>foo</i><b>{</b><p>bar]</p>"],["foo{<div><p>bar]</p></div>","foo[<div><p>bar]</p></div>"],["<i>foo</i>{<div><p>bar]</p></div>","<i>foo[</i><div><p>bar]</p></div>"],["<p>foo</p>{<p>bar]</p>","<p>foo</p><p>[bar]</p>"],["<p>foo{</p><p>bar]</p>","<p>foo[</p><p>bar]</p>"],["<p>foo{</p>bar]","<p>foo[</p>bar]"],["<p>{</p><p>foo]</p>","<p></p><p>[foo]</p>"],["<p>{</p><b>foo]</b>","<p></p><b>[foo]</b>"],["<p>{</p>foo]","<p></p>[foo]"],["<div><p>{</p></div><p>bar]</p>","<div><p></p></div><p>[bar]</p>"]
,["<div><p>{</p><i></i>}<p></p></div>bar","<div><p></p><i></i><p></p></div>[]bar"],["<p>{</p><u></u>bar]","<p></p><u></u>[bar]"],["<p>{</p><p></p>bar]","<p></p><p></p>[bar]"],["foo<p>{</p><p>bar]</p>","foo<p></p><p>[bar]</p>"],["<p>{</p>}<p></p>bar","<p></p><p></p>[]bar"],["<p>{</p>}<p></p>","{}<p></p><p></p>"],["<p>foo{</p><p>bar}</p><p>baz</p>","<p>foo[</p><p>bar]</p><p>baz</p>"],["[foo<b>}<u></u>bar</b>","[foo]<b><u></u>bar</b>"],["[foo<i>}<b><u></u>bar</b></i>","[foo]<i><b><u></u>bar</b></i>"],["[foo<p></p>}<b>bar</b>","[foo<p></p><b>}bar</b>"],["[foo<div><p>}<b>bar</b></p></div>","[foo<div><p>}<b>bar</b></p></div>"],["<p>[foo</p>}<b></b><p>bar</p>","<p>[foo</p><b></b><p>}bar</p>"],["[foo<i><u></u><b>}bar</b></i>","[foo]<i><u></u><b>bar</b></i>"],["[foo<u></u><b>}bar</b>","[foo]<u></u><b>bar</b>"],["{<b>}bar</b>","<b>[]bar</b>"],["[foo<p>}bar</p>","[foo<p>}bar</p>"],["[foo<p><b>}bar</b></p>","[foo<p>}<b>bar</b></p>"],["[foo<p><b></b>}bar</p>","[foo<p>}<b></b>bar</p>"],["[foo<div><p>}bar</p></div>"
,"[foo<div><p>}bar</p></div>"],["{}foo","[]foo"],["[foo<p></p>}bar","[foo<p></p>]bar"],["<p>[foo</p>}bar","<p>[foo</p>]bar"],["[foo}<p>bar</p>","[foo]<p>bar</p>"],["<b>[foo</b>}<p>bar</p>","<b>[foo]</b><p>bar</p>"],["<b>[foo</b>}<p></p>bar","<b>[foo]</b><p></p>bar"],["<b>[foo</b>}<p><b></b>bar</p>","<b>[foo]</b><p><b></b>bar</p>"],["<b>[foo</b>}<p></p>","<b>[foo]</b><p></p>"],["<div><b>[foo</b>}<p></p></div>bar","<div><b>[foo]</b><p></p></div>bar"],["<b>[foo</b>}<p></p>","<b>[foo]</b><p></p>"],["<b>[foo</b>}<p></p><p>bar</p>","<b>[foo]</b><p></p><p>bar</p>"],["{}<p>foo</p>","<p>[]foo</p>"],["<b>foo</b>{}<p>bar</p>","<b>foo[]</b><p>bar</p>"],["<p>foo</p>{}<p>bar</p>","<p>foo</p><p>[]bar</p>"],["[foo<div>}<p>bar</p></div>","[foo<div><p>}bar</p></div>"],["<div><p>[foo</p></div><div>}<p>bar</p></div>","<div><p>[foo</p></div><div><p>}bar</p></div>"],["<p>[foo</p>}<div>bar</div>","<p>[foo</p><div>}bar</div>"],["<p>[foo</p>}<div><b>bar</b></div>","<p>[foo</p><div>}<b>bar</b></div>"],["<p>[foo</p>}<p></p><div>bar</div>"
,"<p>[foo</p><p></p><div>}bar</div>"],["<p>[foo</p>}<p></p><div></div><b>bar</b>","<p>[foo</p><p></p><div></div><b>}bar</b>"],["<p>[foo</p>}<p><b>bar</b></p>","<p>[foo</p><p>}<b>bar</b></p>"],["[foo}<p>bar</p>","[foo]<p>bar</p>"],["<p>[foo</p>}<p>bar</p>","<p>[foo</p><p>}bar</p>"],["<p>[foo</p>}<p><b></b>bar</p>","<p>[foo</p><p>}<b></b>bar</p>"],["<p>[foo</p>}<p><b>bar</b></p>","<p>[foo</p><p>}<b>bar</b></p>"],["<p>[foo</p>}<div><p>test</p></div>","<p>[foo</p><div><p>}test</p></div>"],["<p>[foo</p>}<div></div><p>bar</p>","<p>[foo</p><div></div><p>}bar</p>"],["<p>[foo</p>}<p></p>bar","<p>[foo</p><p></p>]bar"],["<div><p>[foo</p>}<p></p></div>bar","<div><p>[foo]</p><p></p></div>bar"],["<div><p>{</p><b></b>}<p></p></div>bar","<div><p></p><b></b><p></p></div>[]bar"],["<p>{</p>}<p></p>bar","<p></p><p></p>[]bar"],["<p>{</p>}<p></p>","{}<p></p><p></p>"],["<p>[foo}</p>","<p>[foo]</p>"],["[foo<p>}</p>","[foo]<p></p>"],["[foo<div><p>}</p></div>","[foo]<div><p></p></div>"],["<p>[foo<b>bar</b>}</p>"
,"<p>[foo<b>bar]</b></p>"],["<p>[foo<b>bar</b>test}</p>","<p>[foo<b>bar</b>test]</p>"],["<p>[foo<b>bar</b>}</p>test","<p>[foo<b>bar]</b></p>test"],["[foo<div><p><u>bar</u></p>}</div>","[foo<div><p><u>bar]</u></p></div>"],["[foo<div><p><u></u></p>}</div>","[foo]<div><p><u></u></p></div>"],["[foo<div><p>bar<u></u></p>}</div>","[foo<div><p>bar]<u></u></p></div>"]["[foo<p></p>}","[foo]<p></p>"],["[foo<div><p></p></div>}","[foo]<div><p></p></div>"],["[foo<div><p><u></u></p></div>}","[foo]<div><p><u></u></p></div>"],["<p>foo</p>test{<p>bar</p>}<p>baz</p>","<p>foo</p>test[<p>bar</p><p>}baz</p>"],["<p>foo{</p><p>bar}</p><p>baz</p>","<p>foo[</p><p>bar]</p><p>baz</p>"],["<p>foo</p>{<p>bar}</p><p>baz</p>","<p>foo</p><p>[bar]</p><p>baz</p>"]["{}<p></p>","{}<p></p>"],["{<p>}</p>","{}<p></p>"],["{<p></p>}","{}<p></p>"],["{<p></p><p></p>}","{}<p></p><p></p>"],["{<p>}foo</p>","<p>[]foo</p>"],["{<p>}</p>","{}<p></p>"]["{<p></p><p>}</p>","{}<p></p><p></p>"],["{<p></p><p>}foo</p>","<p></p><p>[]foo</p>"],["{<p></p><div><p>}foo</p></div>"
,"<p></p><div><p>[]foo</p></div>"],["{<p></p><div><p>}</p></div>","{}<p></p><div><p></p></div>"],["{<p></p><div></div><p>}foo</p>","<p></p><div></div><p>[]foo</p>"],["{<p></p><div></div><p>}</p>","{}<p></p><div></div><p></p>"],["foo{<b></b><p>bar]</p>","foo<b>{</b><p>bar]</p>"],["foo{<b></b><u></u><p>bar]</p>","foo<b></b><u>{</u><p>bar]</p>"],["foo{<b></b><div></div><p>bar]</p>","foo<b>{</b><div></div><p>bar]</p>"],["<b>foo{<u></u></b><p>bar]</p>","<b>foo<u>{</u></b><p>bar]</p>"],["foo{<b></b><div><u></u></div><p>bar]</p>","foo<b>{</b><div><u></u></div><p>bar]</p>"],["<p>foo{<b></b></p><div><u></u></div><p>bar]</p>","<p>foo<b>{</b></p><div><u></u></div><p>bar]</p>"],["<div>foo{<b></b><i></i></div><div><u></u></div><p>bar]</p>","<div>foo<b></b><i>{</i></div><div><u></u></div><p>bar]</p>"],["<div>foo{<b></b><p></p></div><p>bar]</p>","<div>foo<b>{</b><p></p></div><p>bar]</p>"],["<div>foo{<b></b><p></p></div><div><u></u></div><p>bar]</p>","<div>foo<b>{</b><p></p></div><div><u></u></div><p>bar]</p>"
],["<div>foo<p>test{<b></b></p></div><div><u></u></div><p>bar]</p>","<div>foo<p>test<b>{</b></p></div><div><u></u></div><p>bar]</p>"],["{<b></b><p>foo]</p>","<b></b><p>[foo]</p>"],["{<b></b><u></u><p>foo]</p>","<b></b><u></u><p>[foo]</p>"],["{<b></b><div></div><p>foo]</p>","<b></b><div></div><p>[foo]</p>"],["<b>{<u></u></b><p>foo]</p>","<b><u></u></b><p>[foo]</p>"],["{<b></b><div><u></u></div><p>foo]</p>","<b></b><div><u></u></div><p>[foo]</p>"],["<p>{<b></b></p><div><u></u></div><p>bar]</p>","<p><b></b></p><div><u></u></div><p>[bar]</p>"],["foo{<b></b><p>}</p>","foo[]<b></b><p></p>"],["foo{<b></b><u></u><p>}</p>","foo[]<b></b><u></u><p></p>"],["foo{<b></b><div></div><p>}</p>","foo[]<b></b><div></div><p></p>"],["<b>foo{<u></u></b><p>}</p>","<b>foo[]<u></u></b><p></p>"],["foo{<b></b><div><u></u></div><p>}</p>","foo[]<b></b><div><u></u></div><p></p>"],["<p>foo{<b></b></p><div><u></u></div><p>}</p>","<p>foo[]<b></b></p><div><u></u></div><p></p>"],["{<b></b><p>}</p>","{}<b></b><p></p>"],["{<b></b><u></u><p>}</p>"
,"{}<b></b><u></u><p></p>"],["{<b></b><div></div><p>}</p>","{}<b></b><div></div><p></p>"],["<b>{<u></u></b><p>}</p>","{}<b><u></u></b><p></p>"],["{<b></b><div><u></u></div><p>}</p>","{}<b></b><div><u></u></div><p></p>"],["<p>{<b></b></p><div><u></u></div><p>}</p>","{}<p><b></b></p><div><u></u></div><p></p>"],["<b>foo{<u></u></b>bar]","<b>foo<u></u></b>[bar]"],["<b>foo{</b>bar]","<b>foo</b>[bar]"],["<b>foo{</b><b></b>bar]","<b>foo</b><b></b>[bar]"],["<b>foo{</b><b>bar]</b>","<b>foo</b><b>[bar]</b>"],["<b><u>foo</u>{</b>bar]","<b><u>foo</u></b>[bar]"],["<b>foo<u>{</u></b>bar]","<b>foo<u></u></b>[bar]"],["<b>foo{</b><p></p>bar]","<b>foo[</b><p></p>bar]"],["<b>foo{</b><p>bar]</p>","<b>foo[</b><p>bar]</p>"],["<p><b>foo{</b></p>bar]","<p><b>foo[</b></p>bar]"],["foo<b>{</b>bar]","foo<b></b>[bar]"],["foo<b>{</b><b></b>bar]","foo<b></b><b></b>[bar]"],["foo<b>{</b><b>bar]</b>","foo<b></b><b>[bar]</b>"],["foo<b>{</b><p>bar]</p>","foo<b>{</b><p>bar]</p>"],["foo<b>{</b><p></p>bar]","foo<b>{</b><p></p>bar]"
],["foo<b>{</b><p></p>}","foo[]<b></b><p></p>"],["foo<b>{</b>}","foo[]<b></b>"],["foo<p><b>{</b>}</p>","foo[]<p><b></b></p>"],["<b><u>foo</u>{</b>}","<b><u>foo[]</u></b>"],["<b>foo<u></u>{</b>}","<b>foo[]<u></u></b>"],["<b><u>foo</u>{</b><p></p>}","<b><u>foo[]</u></b><p></p>"],["<b>foo{</b>}","<b>foo[]</b>"],["foo<b>{</b><p>bar]</p>","foo<b>{</b><p>bar]</p>"],["foo<b>{</b><u></u><p>bar]</p>","foo<b></b><u>{</u><p>bar]</p>"],["foo<b>{</b><div></div><p>bar]</p>","foo<b>{</b><div></div><p>bar]</p>"],["<b>foo<u>{</u></b><p>bar]</p>","<b>foo<u>{</u></b><p>bar]</p>"],["foo<b>{</b><div><u></u></div><p>bar]</p>","foo<b>{</b><div><u></u></div><p>bar]</p>"],["<p>foo<b>{</b></p><div><u></u></div><p>bar]</p>","<p>foo<b>{</b></p><div><u></u></div><p>bar]</p>"],["<b>foo{</b><p>bar]</p>","<b>foo[</b><p>bar]</p>"],["<b>foo{</b><u></u><p>bar]</p>","<b>foo</b><u>{</u><p>bar]</p>"],["<b>foo{</b><div></div><p>bar]</p>","<b>foo[</b><div></div><p>bar]</p>"],["<p><b>foo{</b></p><div><u></u></div><p>bar]</p>","<p><b>foo[</b></p><div><u></u></div><p>bar]</p>"
],["<b>{</b><p>foo]</p>","<b></b><p>[foo]</p>"],["<b>{</b><u></u><p>foo]</p>","<b></b><u></u><p>[foo]</p>"],["<b>{</b><div></div><p>foo]</p>","<b></b><div></div><p>[foo]</p>"],["<b><u>{</u></b><p>foo]</p>","<b><u></u></b><p>[foo]</p>"],["<b>{</b><div><u></u></div><p>foo]</p>","<b></b><div><u></u></div><p>[foo]</p>"],["<p><b>{</b></p><div><u></u></div><p>bar]</p>","<p><b></b></p><div><u></u></div><p>[bar]</p>"],["foo<b>{</b><p>}</p>","foo[]<b></b><p></p>"],["foo<b>{</b><u></u><p>}</p>","foo[]<b></b><u></u><p></p>"],["foo<b>{</b><div></div><p>}</p>","foo[]<b></b><div></div><p></p>"],["<b>foo<u>{</u></b><p>}</p>","<b>foo[]<u></u></b><p></p>"],["foo<b>{</b><div><u></u></div><p>}</p>","foo[]<b></b><div><u></u></div><p></p>"],["<p>foo<b>{</b></p><div><u></u></div><p>}</p>","<p>foo[]<b></b></p><div><u></u></div><p></p>"],["<p>{foo]</p>","<p>[foo]</p>"],["<b>{foo]</b>","<b>[foo]</b>"],["foo<p>{bar]</p>","foo<p>[bar]</p>"],["foo<b>{bar]</b>","foo<b>[bar]</b>"],["[foo}bar","[foobar]"],["[foo<p>}bar</p>"
,"[foo<p>}bar</p>"],["[foo<p>}bar</p>test","[foo<p>}bar</p>test"],["[foo<div><p>}bar</p></div>","[foo<div><p>}bar</p></div>"],["<p>[foo</p><b></b>}bar","<p>[foo</p><b>}</b>bar"],["[foo<p></p><b>}bar</b>","[foo<p></p><b>}bar</b>"],["[foo<i><b>}bar</b></i>","[foo]<i><b>bar</b></i>"],["<i>[foo</i><b></b>}bar","<i>[foo]</i><b></b>bar"],["<p>[foo</p><u></u><b></b>}bar","<p>[foo</p><u>}</u><b></b>bar"],["[foo<p><i></i><b></b>}bar</p>","[foo<p>}<i></i><b></b>bar</p>"],["[foo<p><b></b>}bar</p>","[foo<p>}<b></b>bar</p>"],["<p><b>[foo</b></p><p>}bar</p>","<p><b>[foo</b></p><p>}bar</p>"],["[foo<p><b>}bar</b></p>","[foo<p>}<b>bar</b></p>"],["[foo<b>}bar</b>","[foo]<b>bar</b>"],["[foo<p></p>}bar","[foo<p></p>]bar"],["<p>[foo</p>}bar","<p>[foo</p>]bar"],["{<p>foo</p><p>}bar</p>","<p>[foo</p><p>}bar</p>"],["[foo<p></p><b></b>}bar","[foo<p></p><b>}</b>bar"],["[foo<p></p><i></i><b></b>}bar","[foo<p></p><i>}</i><b></b>bar"],["[foo<p><i></i></p><b></b>}bar","[foo<p><i></i></p><b>}</b>bar"],["{<p></p><p>}foo</p>"
,"<p></p><p>[]foo</p>"],["{<p><b></b></p><p>}bar</p>","<p><b></b></p><p>[]bar</p>"],["<p>{}foo</p>","<p>[]foo</p>"],["foo<b>{}</b>bar","foo[]<b></b>bar"],["foo[]<span></span>bar","foo[]<span></span>bar"],["<b>[foo}</b>","<b>[foo]</b>"],["<b>[foo}</b>bar","<b>[foo]</b>bar"],["[foo<b>}</b>","[foo]<b></b>"],["{<b>}</b>bar","<b></b>[]bar"],["<b>[foo<i>bar</i>}</b>","<b>[foo<i>bar]</i></b>"],["[foo<b><i>bar</i>}</b>","[foo<b><i>bar]</i></b>"],["<b>[foo<i></i>}</b>","<b>[foo]<i></i></b>"],["<b>[foo<u></u><i></i>}</b>","<b>[foo]<u></u><i></i></b>"],["<b>[foo<u><i></i></u>}</b>","<b>[foo]<u><i></i></u></b>"],["<b>[foo</b><p></p><i>}</i>","<b>[foo]</b><p></p><i></i>"],["[foo<p></p><b>}</b>bar","[foo<p></p><b>}</b>bar"],["[foo<p><b>}</b>bar</p>","[foo<p>}<b></b>bar</p>"],["[foo<p><b>}</b>bar</p>","[foo<p>}<b></b>bar</p>"],["[foo<p></p><b>}</b>","[foo]<p></p><b></b>"],["[foo<p><b>}</b></p>","[foo]<p><b></b></p>"],["[foo<p><b>}</b></p>bar","[foo<p><b></b></p>]bar"],["[foo<p><b>}</b>bar</p>","[foo<p>}<b></b>bar</p>"
],["[foo<p><b>}</b>bar</p>","[foo<p>}<b></b>bar</p>"],["<b>[foo</b><p><i>}</i></p>","<b>[foo]</b><p><i></i></p>"],["<b>[foo</b><p><b></b><i>}</i></p>","<b>[foo]</b><p><b></b><i></i></p>"],["<b>[foo</b><p><i>}</i></p>bar","<b>[foo</b><p><i></i></p>]bar"],["<b>[foo</b><p>bar<i>}</i></p>","<b>[foo</b><p>bar]<i></i></p>"],["<p>[foo</p><b><i></i>}</b>","<p>[foo]</p><b><i></i></b>"],["<p>[foo</p><b><i></i>}</b>bar","<p>[foo</p><b>}<i></i></b>bar"],["[foo<p></p><b>}</b>bar","[foo<p></p><b>}</b>bar"],["[foo<p></p><i>}</i><b></b>bar","[foo<p></p><i>}</i><b></b>bar"],["[foo<p><i></i></p><b>}</b>bar","[foo<p><i></i></p><b>}</b>bar"],["<div></div>{<b></b><p>}</p>","{}<div></div><b></b><p></p>"],["<div>{<b></b></div><p>}</p>","{}<div><b></b></div><p></p>"],["<b></b><div>{<b></b></div><p>}</p>","{}<b></b><div><b></b></div><p></p>"]["foo{<b><i></i></b>}","foo{}<b><i></i></b>"],["foo{<b></b>}","foo{}<b></b>"],["{<b></b>}","{}<b></b>"],["<p>{<b></b>}</p>","{}<p><b></b></p>"],["<p>{<b></b>}</p>","{}<p><b></b></p>"
],["<i>{<b></b>}</i>","{}<i><b></b></i>"],["<p><i>{<b></b>}</i></p>","{}<p><i><b></b></i></p>"],["<i></i>{<b></b>}","{}<i></i><b></b>"],["<p></p>{<b></b>}","{}<p></p><b></b>"],["<p><i></i></p>{<b></b>}","{}<p><i></i></p><b></b>"],["{<b></b><p></p>}","{}<b></b><p></p>"],["<div><p>{<b></b></p></div><p></p>}","{}<div><p><b></b></p></div><p></p>"],["foo<div><p>{<b></b></p></div><p></p>}","foo[]<div><p><b></b></p></div><p></p>"],[]],u=[],a=[["<div>foo[</div><hr><div>]baz</div>","<div>foo[</div><hr><div>}baz</div>"],["<div>foo[</div><hr><div>}baz</div>","<div>foo[</div><hr><div>}baz</div>"],["<div>foo[</div><hr>}<div>baz</div>","<div>foo[</div><hr><div>}baz</div>"],["<div>foo[</div>}<hr><div>baz</div>","<div>foo[</div>}<hr><div>baz</div>"],["<div>foo{</div><hr><div>]baz</div>","<div>foo[</div><hr><div>}baz</div>"],["<div>foo</div>{<hr><div>]baz</div>","<div>foo</div>{<hr><div>}baz</div>"],["<div>foo</div><hr>{<div>]baz</div>","<div>foo</div><hr><div>[]baz</div>"],["foo{<div><div>bar]</div></div>"
,"foo[<div><div>bar]</div></div>"],["foo<div>{<div>bar]</div></div>","foo<div><div>[bar]</div></div>"],["foo<div>{<div>bar}</div></div>","foo<div><div>[bar]</div></div>"],["foo<div>{<div>bar</div>}</div>","foo<div><div>[bar]</div></div>"]],f=[["foo<ol><li>[bar]</li></ol>baz","foo<ol><li>[bar]</li></ol>baz"],["foo<ol><li data-start=0>bar]</li></ol>baz","foo<ol><li>[bar]</li></ol>baz"],["foo<ol><li>[bar}</li></ol>baz","foo<ol><li>[bar]</li></ol>baz"],["foo<ol><li>{bar}</li></ol>baz","foo<ol><li>[bar]</li></ol>baz"],["foo<ol data-start=0><li>bar]</li></ol>baz","foo<ol><li>[bar]</li></ol>baz"],["foo<ol data-start=0 data-end=1><li>bar</li></ol>baz","foo<ol><li>[bar]</li></ol>baz"],["foo[<ol><li>bar</li></ol>]baz","foo[<ol><li>bar</li></ol>]baz"],["foo{<ol><li>bar</li></ol>}baz","foo[<ol><li>bar</li></ol>]baz"],["foo[<ol><li>bar]</li></ol>baz","foo[<ol><li>bar]</li></ol>baz"],["foo{<ol><li>bar}</li></ol>baz","foo[<ol><li>bar]</li></ol>baz"],["foo[<ol><li>]bar</li></ol>baz","foo[<ol><li>}bar</li></ol>baz"
],["foo{<ol><li>}bar</li></ol>baz","foo[<ol><li>}bar</li></ol>baz"],["foo<ol><li>bar[</li><li>]bar</li></ol>baz","foo<ol><li>bar[</li><li>}bar</li></ol>baz"],["foo<ol><li>bar{</li><li>}bar</li></ol>baz","foo<ol><li>bar[</li><li>}bar</li></ol>baz"],["foo<ol><li>[bar<ol><li>]bam</li></ol></li></ol>baz","foo<ol><li>[bar<ol><li>}bam</li></ol></li></ol>baz"]];Aloha.ready(function(){function t(e,t,n){l=[];for(var r=0;r<n.length;r++){if(!n[r])continue;jQuery.isArray(n[r])?(c=[],c[0]=n[r][0].replace(e,t),c[1]=n[r][1].replace(e,t)):c=n[r].replace(e,t),l.push(c)}return l}var n=Aloha.jQuery("#edit"),r=Aloha.jQuery("<div>"),i=[],s=["hr","img","input"],u=["a","em","strong","small","mark","abbr","dfn","i","b","s","u","code","var","samp","kbd","sup","sub","q","cite","bdo","bdi","ins","del","ruby","time"],a=["pre","div","h1","h2","h3","h4","h5","h6","address","blockquote"],f=["address","blockquote"],l,c;i=i.concat(o,[]);for(var h=0;h<s.length;h++)if(!i[h])continue;for(var h=0;h<u.length;h++)if(!i[h])continue;
for(var h=0;h<u.length;h++){if(!i[h])continue;if(u[h]=="a")continue}for(var h=0;h<a.length;h++)if(!i[h])continue;for(var h=0;h<f.length;h++)if(!i[h])continue;n.aloha();for(var h=tests_start;h<tests_stop&&h<i.length;h++){if(!i[h])continue;var p=typeof i[h]=="string"?i[h]:i[h][0],d=typeof i[h]=="string"?i[h]:i[h][1],v=r.text(p).html();module("Selection "+(h+1)+" : "+v,{setup:function(){n.html(this.start),n.focus()},teardown:function(){}}),test(name,{start:p,expected:d},function(){var t=e.addRange(n),r,i;Aloha.getSelection().removeAllRanges();var s=Aloha.createRange();s.setStart(t.startContainer,t.startOffset),s.setEnd(t.endContainer,t.endOffset),Aloha.getSelection().addRange(s),r=Aloha.getSelection().getRangeAt(0),e.addBrackets(r),i=Aloha.editables[0].getContents(),i=i.replace(/[\s\n\r]/g,""),deepEqual(i.toLowerCase(),this.expected,"Check Operation Result")})}})})